<!DOCTYPE html>
<html>
<head>
  <title>Your Chatbot Page</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style>
    .link-bubble {
      background-color: #f1f1f1;
      padding: 10px;
      border-radius: 5px;
      display: inline-block;
      cursor: pointer;
    }
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
    }
    .overlay iframe {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 80%;
      height: 80%;
      transform: translate(-50%, -50%);
    }
  </style>
</head>
<body>

  <!-- Overlay for iframe -->
  <div class="overlay">
    <iframe id="overlay-iframe" src=""></iframe>
  </div>

  <script src="https://cdn.botpress.cloud/webchat/v0/inject.js"></script>
  <script src="https://mediafiles.botpress.cloud/0424fb08-e9bf-4780-b3b7-566595200794/webchat/config.js" defer></script>
  <script>
    $(document).ready(function() {
      function observeChat() {
        const chatElement = document.querySelector('.bpw-chat');
        if (chatElement) {
          const observer = new MutationObserver(function() {
            $(".bpw-message-text").each(function() {
              var html = $(this).html();
              var urlRegex = /(https?:\/\/[^\s]+)/g;
              $(this).html(html.replace(urlRegex, '<div class="link-bubble" data-url="$1">$1</div>'));
            });

// Add click event to link bubble
$(".link-bubble").click(function(event) {
  event.preventDefault();  // Prevent default click behavior
  const url = $(this).attr('data-url');
  $('#overlay-iframe').attr('src', url);
  $('.overlay').show();
});


          observer.observe(chatElement, {
            attributes: true,
            childList: true,
            subtree: true
          });
        } else {
          setTimeout(observeChat, 1000);
        }
      }
      
      // Start observing the chat
      observeChat();

      // Close overlay on click
      $('.overlay').click(function() {
        $(this).hide();
      });
    });
  </script>
</body>
</html>

